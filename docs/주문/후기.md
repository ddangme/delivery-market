# 후기
## Table
### review
| 컬럼명        | 설명      | 데이터 타입        | 제약 조건                                                               |
|------------|---------|---------------|---------------------------------------------------------------------|
| id         | 식별자     | BIGINT        | PK                                                                  |
| option_id  | 구매한 옵션  | BIGINT        | FK (good_option - id)                                               |
| rating     | 별점      | DECIMAL(2, 2) | CHECK (MOD(rating * 10, 5) = 0 AND rating >= 0.0 AND rating <= 5.0) |
| content    | 후기 내용   | VARCHAR(4000) | CHECK(CHAR_LENGTH 10 ~ 1000)                                        |
| point      | 적립된 포인트 | INT           | NOT NULL                                                            |
| is_best    | 베스트 여부  | BOOLEAN       | NOT NULL                                                            |
| created_by | 생성자     | BIGINT        | - FK (member - id) <br/>- NOT NULL                                  |
| created_at | 생성일시    | TIMESTAMP     | NOT NULL                                                            |
| updated_at | 수정일시    | TIMESTAMP     | NOT NULL                                                            |
| deleted_at | 삭제일시    | TIMESTAMP     |                                                                     |

```mysql
CREATE TABLE review
(
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    option_id BIGINT,
    rating DECIMAL(2, 1),
    content VARCHAR(4000),
    point INT NOT NULL,
    is_best BOOLEAN NOT NULL,
    created_by BIGINT NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    deleted_at TIMESTAMP,

    FOREIGN KEY (option_id) REFERENCES good_option(id),
    FOREIGN KEY (created_by) REFERENCES member(id),

    CHECK (MOD(rating * 10, 5) = 0 AND rating >= 0.0 AND rating <= 5.0),
    CHECK (CHAR_LENGTH(content) BETWEEN 10 AND 1000)
);
```

### review_delete
| 컬럼명       | 설명      | 데이터 타입        | 제약 조건                            |
|-----------|---------|---------------|----------------------------------|
| id        | 식별자     | BIGINT        | PK                               |
| review_id | 상품 식별자  | BIGINT        | NOT NULL<br/>- FK (review - id)  |
| delete_by | 관리자 식별자 | BIGINT        | - FK (admin - id)<br/>- NOT NULL |
| memo      | 삭제 사유   | VARCHAR(4000) | CHECK(CHAR_LENGTH 10 ~ 1000)     |

```mysql
CREATE TABLE review_delete (
    id BIGINT PRIMARY KEY,
    delete_by BIGINT NOT NULL,
    review_id BIGINT NOT NULL,
    memo VARCHAR(4000),
    
    FOREIGN KEY (delete_by) REFERENCES admin(id),
    FOREIGN KEY (review_id) REFERENCES review(id),
    CHECK (CHAR_LENGTH(memo) BETWEEN 10 AND 1000)
);
```
### review_photo
| 컬럼명       | 설명                     | 데이터 타입       | 제약 조건                           |
|-----------|------------------------|--------------|---------------------------------|
| id        | 식별자                    | BIGINT       | PK                              |
| review_id | 상품 식별자                 | BIGINT       | NOT NULL<br/>- FK (review - id) |
| photo     | 대표 상품 이미지(서버에 저장된 파일명) | VARCHAR(500) | NOT NULL                        |

```mysql
CREATE TABLE review_photo (
    id BIGINT PRIMARY KEY,
    review_id BIGINT NOT NULL,
    photo VARCHAR(500) NOT NULL,
  
    FOREIGN KEY (review_id) REFERENCES review(id)
);
```
### review_like
| 컬럼명       | 설명     | 데이터 타입 | 제약 조건                           |
|-----------|--------|--------|---------------------------------|
| id        | 식별자    | BIGINT | PK                              |
| member_id | 회원 식별자 | BIGINT | NOT NULL<br/>- FK (Member - id) |
| review_id | 상품 식별자 | BIGINT | NOT NULL<br/>- FK (review - id) |

```mysql
CREATE TABLE review_like (
    id BIGINT PRIMARY KEY,
    member_id BIGINT NOT NULL,
    review_id BIGINT NOT NULL,
  
    FOREIGN KEY (member_id) REFERENCES Member(id),
    FOREIGN KEY (review_id) REFERENCES review(id)
);
```

### 기능
#### 사용자
- [ ] 후기 작성 시 캐시로 구매한 금액에 비례하여 포인트가 적립된다.
  - [ ] 사진 첨부 시 2%
  - [ ] 사진 미 첨부 시 1%
- [ ] 구매 내역 상세에서 후기 작성 버튼 클릭 후 작성할 수 있다.
- [ ] 마이페이지의 상품 후기 탭에서 작성 가능 후기와 작성한 후기 탭이 노출된다.
- [ ] 구매 후 1달이 지나기 전에 후기를 작성할 수 있다.
- [ ] 사진은 최대 8장 까지 업로드할 수 있다.
- [ ] 상품과 무관하거나 반복되는 단어/문장을 사용하여 후기로 볼 수 없는 글의 경우 통보없이 삭제되며 적립금을 회수한다.
- [ ] 후기는 최소 10자에서 1000자 까지 입력 가능하다.

#### 관리자
- [ ] 삭제할 경우 삭제 사유를 작성해야 한다.
- [ ] 삭제 사유는 최소 10자에서 1000자 까지 입력 가능하다.